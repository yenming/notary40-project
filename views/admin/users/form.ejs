<!-- Back Button -->
<div class="mb-3">
  <a href="/admin/users" class="btn btn-secondary">
    <i class="fas fa-arrow-left me-1"></i>
    返回用戶列表
  </a>
</div>

<!-- User Form Card -->
<div class="card card-primary card-outline">
  <div class="card-header">
    <h3 class="card-title">
      <i class="fas fa-<%= user ? 'edit' : 'user-plus' %> me-1"></i>
      <%= user ? '編輯用戶' : '新增用戶' %>
    </h3>
  </div>
  <form method="POST" action="<%= user ? `/admin/users/${user.id}/edit` : '/admin/users/create' %>">
    <div class="card-body">
      <% if (typeof error !== 'undefined' && error) { %>
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-circle me-2"></i>
        <%= error %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      <% } %>

      <div class="form-group mb-3">
        <label for="name">姓名 <span class="text-danger">*</span></label>
        <input
          type="text"
          class="form-control"
          id="name"
          name="name"
          placeholder="請輸入姓名"
          required
          value="<%= user ? user.name : (typeof formData !== 'undefined' && formData ? formData.name : '') %>"
        />
      </div>

      <div class="form-group mb-3">
        <label for="email">電子郵件 <span class="text-danger">*</span></label>
        <input
          type="email"
          class="form-control"
          id="email"
          name="email"
          placeholder="請輸入電子郵件"
          required
          value="<%= user ? user.email : (typeof formData !== 'undefined' && formData ? formData.email : '') %>"
        />
      </div>

      <div class="form-group mb-3">
        <label for="password">
          密碼 <% if (!user) { %><span class="text-danger">*</span><% } %>
          <% if (user) { %>
          <small class="text-muted">（留空則不修改）</small>
          <% } else { %>
          <small class="text-muted">（至少 8 個字元）</small>
          <% } %>
        </label>
        <input
          type="password"
          class="form-control"
          id="password"
          name="password"
          placeholder="<%= user ? '留空則不修改密碼' : '請輸入密碼' %>"
          <% if (!user) { %>required<% } %>
          <% if (!user) { %>minlength="8"<% } %>
        />
      </div>
    </div>
    <div class="card-footer">
      <button type="submit" class="btn btn-primary">
        <i class="fas fa-save me-1"></i>
        <%= user ? '更新' : '創建' %>
      </button>
      <a href="/admin/users" class="btn btn-secondary">
        <i class="fas fa-times me-1"></i>
        取消
      </a>
    </div>
  </form>
</div>

